"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var r=require("vest-utils"),n=require("n4s");function e(r,n){var e={pass:r};return n&&(e.message=n),e}function t(){return e(!1)}function u(){return e(!0)}function a(r,n){try{return r.run(n)}catch(r){return t()}}function i(r,e){var t=function(t){var u=r[t],i=e[t],o=n.ctx.run({value:u,set:!0,meta:{key:t}},(function(){return a(i,u)}));if(!o.pass)return{value:o}};for(var i in e){var o=t(i);if("object"==typeof o)return o.value}return u()}n.enforce.extend({isArrayOf:function(e,t){return i=r.mapFirst(e,(function(r,e,u){var i=n.ctx.run({value:r,set:!0,meta:{index:u}},(function(){return a(t,r)}));e(!i.pass,i)})),r.defaultTo(i,u());var i},loose:i,optional:function(n,e){return r.isNullish(n)?u():a(e,n)},shape:function(n,e){var a=i(n,e);if(!a.pass)return a;for(var o in n)if(!r.hasOwnProperty(e,o))return t();return u()}}),exports.partial=function(r){var e={};for(var t in r)e[t]=n.enforce.optional(r[t]);return e};
